<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>STEM Learn</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Poppins', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      background-color: #0b0c1a;
      color: #fff;
      line-height: 1.8;
      overflow-x: hidden;
      font-size: 1.1rem;
      font-weight: 400;
      padding: 0 1rem;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    button {
      font-family: 'Poppins', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      cursor: pointer;
    }

    .container {
      width: 70%;
      margin: 0 auto;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 0;
      border-bottom: 1px solid #1f1f3f;
    }

    header .logo {
      font-size: 1.8rem;
      color: #00fff7;
      letter-spacing: 2px;
    }

    nav ul {
      list-style: none;
      display: flex;
      gap: 1.5rem;
    }

    /* Hamburger Menu Styles */
    .hamburger {
      display: none;
      flex-direction: column;
      cursor: pointer;
      z-index: 1001;
    }

    .hamburger span {
      width: 25px;
      height: 3px;
      background: #00fff7;
      margin: 3px 0;
      transition: 0.3s;
      border-radius: 3px;
    }

    .hamburger.active span:nth-child(1) {
      transform: rotate(-45deg) translate(-5px, 6px);
    }

    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }

    .hamburger.active span:nth-child(3) {
      transform: rotate(45deg) translate(-5px, -6px);
    }

    .dropdown {
      position: relative;
    }

    .dropdown-content {
      display: none;
      position: absolute;
      background-color: #1f1f3f;
      min-width: 200px;
      box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
      z-index: 1000;
      border: 1px solid #00fff7;
      border-radius: 5px;
      top: 100%;
      left: 0;
      padding: 0.5rem 0;
    }

    .dropdown-content a {
      color: #fff;
      padding: 12px 16px;
      text-decoration: none;
      display: block;
      transition: 0.3s;
      border-bottom: 1px solid #333;
    }

    .dropdown-content a:last-child {
      border-bottom: none;
    }

    .dropdown-content a:hover {
      background-color: #00fff7;
      color: #0b0c1a;
    }

    .dropdown:hover .dropdown-content {
      display: block;
    }

    nav ul li a {
      color: #fff;
      font-weight: bold;
      position: relative;
      transition: 0.3s;
    }

    nav ul li a::after {
      content: '';
      position: absolute;
      width: 0%;
      height: 2px;
      bottom: -3px;
      left: 0;
      background-color: #00fff7;
      transition: 0.3s;
    }

    nav ul li a:hover::after {
      width: 100%;
    }

    .hero {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      min-height: 90vh;
      background: linear-gradient(135deg, #0b0c1a 0%, #1f1f3f 100%);
      position: relative;
      padding: 0 1rem;
      overflow: hidden;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="%2300fff7" stroke-width="0.3" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      animation: gridMove 20s linear infinite;
      z-index: 1;
    }

    .hero::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 80%, rgba(0, 255, 247, 0.1) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255, 0, 255, 0.1) 0%, transparent 50%);
      animation: pulse 4s ease-in-out infinite alternate;
      z-index: 2;
    }

    @keyframes gridMove {
      0% { transform: translate(0, 0); }
      100% { transform: translate(10px, 10px); }
    }

    @keyframes pulse {
      0% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    .hero-content {
      position: relative;
      z-index: 3;
    }

    .floating-elements {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 2;
    }

    .floating-code {
      position: absolute;
      color: #00fff7;
      font-family: 'Courier New', monospace;
      font-size: 0.8rem;
      opacity: 0.3;
      animation: float 6s ease-in-out infinite;
    }

    .floating-code:nth-child(1) {
      top: 20%;
      left: 10%;
      animation-delay: 0s;
    }

    .floating-code:nth-child(2) {
      top: 25%;
      right: 15%;
      animation-delay: 2s;
    }

    .floating-code:nth-child(3) {
      bottom: 30%;
      left: 20%;
      animation-delay: 4s;
    }

    .floating-code:nth-child(4) {
      top: 60%;
      right: 25%;
      animation-delay: 1s;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
      50% { transform: translateY(-20px) rotate(5deg); opacity: 0.6; }
    }

    @keyframes glow {
      0% { 
        filter: brightness(1) drop-shadow(0 0 20px #00fff7);
        transform: scale(1);
      }
      100% { 
        filter: brightness(1.2) drop-shadow(0 0 40px #3b82f6);
        transform: scale(1.02);
      }
    }

    .hero h1 {
      font-size: 3rem;
      color: #00fff7;
      margin-bottom: 1rem;
      text-shadow: 0 0 10px #00fff7;
    }

    .hero p {
      font-size: 1.4rem;
      margin-bottom: 2rem;
      color: #e2e8f0;
      line-height: 1.7;
    }

    .hero .btn {
      background: transparent;
      border: 2px solid #00fff7;
      padding: 0.75rem 2rem;
      font-size: 1rem;
      color: #00fff7;
      transition: 0.3s;
      border-radius: 5px;
    }

    .hero .btn:hover {
      background-color: #00fff7;
      color: #0b0c1a;
      box-shadow: 0 0 10px #00fff7;
    }

    .about {
      padding: 5rem 0;
      text-align: center;
      background-color: #101128;
    }

    .about h2 {
      font-size: 2.5rem;
      color: #00d9ff;
      margin-bottom: 1rem;
      text-shadow: 0 0 10px #00bfff;
    }

    .about p {
      max-width: 800px;
      margin: 0 auto 1.5rem auto;
      color: #cbd5e1;
      font-size: 1.2rem;
      line-height: 1.8;
    }

    .courses {
      padding: 5rem 0;
      background-color: #0b0c1a;
      text-align: center;
    }

    .courses h2 {
      font-size: 2.5rem;
      color: #00fff7;
      margin-bottom: 3rem;
      text-shadow: 0 0 10px #00fff7;
    }

    .course-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
    }

    .card {
      background-color: #1f1f3f;
      border: 1px solid #00fff7;
      border-radius: 10px;
      padding: 2rem;
      transition: 0.3s;
    }

    .card:hover {
      transform: translateY(-10px) scale(1.02);
      box-shadow: 0 0 30px #00fff7, 0 0 60px rgba(0, 255, 247, 0.3);
      border-color: #3b82f6;
    }

    .card h3:hover {
      color: #00fff7;
      text-shadow: 0 0 10px #00fff7;
    }

    .card .btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 15px #3b82f6;
    }

    .contact {
      padding: 5rem 0;
      background-color: #101128;
      text-align: center;
    }

    .contact h2 {
      font-size: 2.5rem;
      color: #00d9ff;
      margin-bottom: 3rem;
      text-shadow: 0 0 10px #00bfff;
    }

    .contact-container {
      max-width: 800px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 3rem;
      align-items: start;
    }

    .contact-info {
      text-align: left;
    }

    .contact-info h3 {
      color: #00fff7;
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
    }

    .contact-info p {
      color: #ccc;
      margin-bottom: 1rem;
      line-height: 1.6;
    }

    .contact-info .email {
      color: #3b82f6;
      font-weight: bold;
      font-size: 1.1rem;
    }

    .contact-form {
      background-color: #1f1f3f;
      padding: 2rem;
      border-radius: 10px;
      border: 1px solid #00fff7;
    }

    .form-group {
      margin-bottom: 1.5rem;
      text-align: left;
    }

    .form-group label {
      display: block;
      color: #00fff7;
      margin-bottom: 0.5rem;
      font-weight: bold;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #00fff7;
      border-radius: 5px;
      background-color: #1f1f3f;
      color: #fff;
      font-family: 'Poppins', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      font-size: 1rem;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
    }

    .form-group textarea {
      height: 120px;
      resize: vertical;
    }

    .submit-btn {
      background: linear-gradient(45deg, #00fff7, #3b82f6);
      border: none;
      padding: 0.75rem 2rem;
      color: #0b0c1a;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
      font-family: 'Poppins', 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
      font-size: 1rem;
    }

    .submit-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(0, 255, 247, 0.5);
    }

    @media (max-width: 768px) {
      .contact-container {
        grid-template-columns: 1fr;
        gap: 2rem;
      }
      
      .contact .container > div {
        grid-template-columns: 1fr !important;
        gap: 2rem !important;
      }
    }

    .card h3 {
      color: #3b82f6;
      margin-bottom: 1rem;
    }

    .card p {
      color: #ccc;
      margin-bottom: 1.5rem;
    }

    .card .btn {
      border: 2px solid #3b82f6;
      color: #3b82f6;
      padding: 0.5rem 1.5rem;
      transition: 0.3s;
    }

    .card .btn:hover {
      background-color: #3b82f6;
      color: #0b0c1a;
      box-shadow: 0 0 10px #3b82f6;
    }

    footer {
      text-align: center;
      padding: 2rem 0;
      border-top: 1px solid #1f1f3f;
      background-color: #101128;
      color: #777;
      font-size: 0.9rem;
    }

    /* Mobile Responsive Styles */
    @media (max-width: 768px) {
      /* Show hamburger, hide desktop nav */
      .hamburger {
        display: flex;
        margin-left: auto;
        order: 2;
      }
      
      header {
        justify-content: space-between;
        align-items: center;
        width: 100%;
        max-width: 100%;
        padding: 1rem;
        margin: 0;
      }
      
      header .logo {
        order: 1;
        flex: 0 0 auto;
      }
      
      .hamburger {
        flex: 0 0 auto;
        margin-left: auto;
      }

      nav ul {
        position: fixed;
        right: -100%;
        top: 0;
        flex-direction: column;
        background-color: #0b0c1a;
        width: 80%;
        max-width: 300px;
        height: 100vh;
        padding: 5rem 2rem 2rem;
        box-shadow: -2px 0 10px rgba(0, 0, 0, 0.5);
        transition: right 0.3s ease-in-out;
        z-index: 1000;
        gap: 0;
      }

      nav ul.active {
        right: 0;
      }

      nav ul li {
        width: 100%;
        padding: 1rem 0;
        border-bottom: 1px solid #1f1f3f;
      }

      .dropdown-content {
        position: static;
        display: none;
        box-shadow: none;
        border: none;
        border-radius: 0;
        background-color: #1f1f3f;
        padding-left: 1rem;
        margin-top: 0.5rem;
      }

      .dropdown.active .dropdown-content {
        display: block;
      }

      /* Typography adjustments */
      body {
        font-size: 1rem;
      }

      header .logo {
        font-size: 1.5rem;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .hero p {
        font-size: 0.95rem;
      }

      .hero {
        min-height: 70vh;
        padding: 2rem 1rem;
      }

      /* Cards and Grids */
      .courses-grid, .features-grid, .pricing-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem;
      }

      .card {
        padding: 1.5rem;
      }

      .card h3 {
        font-size: 1.3rem;
      }

      .card p {
        font-size: 0.95rem;
      }

      /* Buttons */
      .btn, .cta-btn, .submit-btn, .test-btn {
        padding: 0.8rem 1.5rem;
        font-size: 1rem;
      }

      /* Forms */
      .form-group {
        margin-bottom: 1rem;
      }

      input, textarea, select {
        font-size: 1rem;
        background-color: #1f1f3f !important;
        color: #fff !important;
      }

      /* Container adjustments */
      .container {
        width: 95%;
        padding: 0 1rem;
      }

      /* Body padding for tablet */
      body {
        padding: 0 1.5rem;
      }

      /* About section mobile improvements */
      .about p {
        padding: 0 1.5rem;
        font-size: 1.15rem;
        line-height: 1.8;
        margin-bottom: 1.5rem;
      }

      .about h2 {
        font-size: 2.2rem;
        padding: 0 1.5rem;
        margin-bottom: 1.5rem;
      }

      /* Pricing cards */
      .price {
        font-size: 2rem !important;
      }

      /* Registration CTA */
      div[style*="display: flex"] {
        flex-direction: column !important;
      }

      /* Hide decorative elements on mobile for performance */
      .hero::before,
      .hero::after {
        display: none;
      }
    }

    @media (max-width: 480px) {
      header .logo {
        font-size: 1.2rem;
      }

      .hero h1 {
        font-size: 1.7rem;
      }

      .hero p {
        font-size: 0.9rem;
      }

      .card {
        padding: 1.2rem;
      }

      .price {
        font-size: 1.8rem !important;
      }

      /* Better mobile padding */
      .container {
        width: 95%;
        padding: 0 1.5rem;
      }

      body {
        padding: 0.5rem 1rem;
      }

      .hero {
        padding: 2rem 1rem;
      }

      .about, .courses, .contact {
        padding: 3rem 0;
      }

      /* Additional about section mobile improvements */
      .about {
        text-align: left;
      }

      .about .container {
        max-width: 100%;
        padding: 0 1rem;
      }

      /* Email contact mobile improvements */
      .email {
        word-break: break-all;
        text-align: center !important;
        padding: 0 1rem;
      }

      .about p {
        padding: 0 2rem;
        font-size: 1.1rem;
        line-height: 1.8;
        margin-bottom: 1.5rem;
      }

      .about h2 {
        font-size: 2rem;
        padding: 0 2rem;
        margin-bottom: 1.5rem;
      }
    }
  </style>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
  
  <!-- Stripe SDK -->
  <script src="https://js.stripe.com/v3/"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics-compat.js"></script>
  <script src="/firebase-config.js"></script>
  <!-- Fallback Firebase config if external file fails -->
  <script>
    // Fallback Firebase configuration
    if (typeof firebase === 'undefined') {
      console.error('Firebase SDK not loaded');
    } else if (typeof initializeFirebase === 'undefined') {
      console.warn('Firebase config file not loaded, using fallback configuration');
      
      const firebaseConfig = {
        apiKey: "AIzaSyDdqm04nmlWzCIfnU1QFW1kDKhk9-ttFqM",
        authDomain: "stemlearn-fcda0.firebaseapp.com",
        projectId: "stemlearn-fcda0",
        storageBucket: "stemlearn-fcda0.firebasestorage.app",
        messagingSenderId: "837054140017",
        appId: "1:837054140017:web:d5ec35fc7b52fe92aa15d0",
        measurementId: "G-4C2NEV3QNL"
      };
      
      // Initialize Firebase with fallback config
      try {
        if (firebase.apps.length === 0) {
          firebase.initializeApp(firebaseConfig);
        }
        
        const db = firebase.firestore();
        const auth = firebase.auth();
        const analytics = firebase.analytics();
        
        window.firebase = firebase;
        window.db = db;
        window.auth = auth;
        window.analytics = analytics;
        
        console.log('Firebase initialized with fallback configuration');
      } catch (error) {
        console.error('Firebase fallback initialization failed:', error);
      }
    }
  </script>
  
  <script>
    
    // Firebase initialization check function
    function ensureFirebaseInitialized() {
      // Use the global Firebase initialization function
      if (typeof initializeFirebase === 'function') {
        return initializeFirebase();
      }
      
      // Fallback if initializeFirebase is not available
      return new Promise((resolve, reject) => {
        // Check if Firebase is already initialized
        if (typeof firebase !== 'undefined' && firebase.apps && firebase.apps.length > 0) {
          if (typeof window.db === 'undefined' && firebase.firestore) {
            window.db = firebase.firestore();
            console.log('Firebase database initialized on demand');
          }
          resolve(true);
          return;
        }
        
        // Wait for Firebase to load
        let attempts = 0;
        const maxAttempts = 50; // 5 seconds max wait
        
        const checkFirebase = () => {
          attempts++;
          
          if (typeof firebase !== 'undefined' && firebase.apps && firebase.apps.length > 0) {
            if (typeof window.db === 'undefined' && firebase.firestore) {
              window.db = firebase.firestore();
              console.log('Firebase database initialized after waiting');
            }
            resolve(true);
          } else if (attempts >= maxAttempts) {
            console.error('Firebase failed to initialize after 5 seconds');
            reject(new Error('Firebase initialization timeout'));
          } else {
            setTimeout(checkFirebase, 100);
          }
        };
        
        checkFirebase();
      });
    }

    // Dropdown functionality
    document.addEventListener('DOMContentLoaded', function() {
      const dropdowns = document.querySelectorAll('.dropdown');
      
      dropdowns.forEach(function(dropdown) {
        const dropdownContent = dropdown.querySelector('.dropdown-content');
        
        if (dropdownContent) {
          // Show dropdown on hover
          dropdown.addEventListener('mouseenter', function() {
            dropdownContent.style.display = 'block';
          });
          
          // Hide dropdown when mouse leaves
          dropdown.addEventListener('mouseleave', function() {
            dropdownContent.style.display = 'none';
          });
          
          // Keep dropdown open when hovering over content
          dropdownContent.addEventListener('mouseenter', function() {
            dropdownContent.style.display = 'block';
          });
          
          // Hide dropdown when mouse leaves content
          dropdownContent.addEventListener('mouseleave', function() {
            dropdownContent.style.display = 'none';
          });
        }
      });
    });

    async function registerUser(event) {
      try {
        if (event && event.preventDefault) {
        event.preventDefault();
        }
        
        // Get form data
        const form = document.getElementById('contactForm');
        
        if (!form) {
          console.error('Form not found!');
          showMessage('Form not found. Please refresh the page and try again.', 'error');
          return;
        }
        
        const formData = new FormData(form);
        
        // Validate required fields
        const studentName = formData.get('studentName');
        const grade = formData.get('grade');
        const courseInterest = formData.get('courseInterest');
        const parentName = formData.get('parentName');
        const email = formData.get('email');
        
        if (!studentName || !grade || !courseInterest || !parentName || !email) {
          console.error('Missing required fields');
          showMessage('Please fill in all required fields (marked with *)', 'error');
          return;
        }
        
        // Ensure Firebase is initialized
        try {
          await ensureFirebaseInitialized();
          console.log('Firebase is ready for database operations');
        } catch (error) {
          console.error('Firebase initialization failed:', error);
          
          // Check if this is a deployment issue
          const isDeployed = window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1';
          
          if (isDeployed) {
            showMessage('Database is temporarily unavailable on our server. Please try again in a few moments, or contact us directly at stemlearn.co.uk@gmail.com', 'error');
          } else {
            showMessage('Database is not available. Please check your internet connection and try again.', 'error');
          }
          return;
        }
        
        // Check if Firebase is properly configured (not using placeholder values)
        if (!firebase.firestore.FieldValue || !firebase.firestore.FieldValue.serverTimestamp) {
          sendEmailFallback(formData);
          return;
        }

        // Check if user is already registered by email
        db.collection('users').where('email', '==', email).get()
          .then((querySnapshot) => {
            if (!querySnapshot.empty) {
              // User already exists
              const existingUser = querySnapshot.docs[0];
              const existingData = existingUser.data();
              
              // Store existing user ID in session storage
              sessionStorage.setItem('userId', existingUser.id);
              sessionStorage.setItem('studentName', existingData.studentName);
              sessionStorage.setItem('grade', existingData.grade);
              
              // Show logout button
              document.getElementById('logoutBtn').style.display = 'block';
              
              showMessage(`Welcome back, ${existingData.studentName}! You are already registered. You can now take assessments.`, 'success');
              form.reset();
            } else {
              // User doesn't exist, proceed with registration
              saveNewUser(formData);
            }
          })
          .catch((error) => {
            console.error('Error checking existing user:', error);
            showMessage('Error checking registration. Please try again.', 'error');
          });
        
      } catch (error) {
        console.error('Unexpected error in registerUser function:', error);
        showMessage('An unexpected error occurred. Please try again. Error: ' + error.message, 'error');
      }
    }

    // Save new user to Firebase
    async function saveNewUser(formData) {
      // Ensure Firebase is initialized
      try {
        await ensureFirebaseInitialized();
        console.log('Firebase is ready for saveNewUser operations');
      } catch (error) {
        console.error('Firebase initialization failed in saveNewUser:', error);
        
        // Check if this is a deployment issue
        const isDeployed = window.location.hostname !== 'localhost' && window.location.hostname !== '127.0.0.1';
        
        if (isDeployed) {
          console.log('Deployment detected, falling back to email due to Firebase issues');
        }
        
        sendEmailFallback(formData);
        return;
      }
      
      const form = document.getElementById('contactForm');
      const trialType = formData.get('trialType') || 'Regular Registration';
      
      // Create user registration data
      const userData = {
        studentName: formData.get('studentName'),
        grade: formData.get('grade'),
        courseInterest: formData.get('courseInterest'),
        city: formData.get('city'),
        country: formData.get('country'),
        parentName: formData.get('parentName'),
        email: formData.get('email'),
        phone: formData.get('phone'),
        hearAbout: formData.get('hearAbout'),
        message: formData.get('message'),
        trialType: trialType,
        registrationDate: firebase.firestore.FieldValue ? firebase.firestore.FieldValue.serverTimestamp() : new Date(),
        status: trialType === 'Free Trial' ? 'trial_pending' : 'pending',
        userAgent: navigator.userAgent,
        ipAddress: '', // Will be filled by server
        assessments: [], // Will store assessment results
        courses: [] // Will store enrolled courses
      };

      // Save user registration to Firestore
      db.collection('users').add(userData)
        .then((docRef) => {
          console.log('User registered with ID: ', docRef.id);
          
          // Store user ID in session storage for assessments
          sessionStorage.setItem('userId', docRef.id);
          sessionStorage.setItem('studentName', userData.studentName);
          sessionStorage.setItem('grade', userData.grade);
          
          // Track registration event
          if (typeof analytics !== 'undefined') {
            analytics.logEvent('user_registration', {
              student_name: userData.studentName,
              grade: userData.grade,
              city: userData.city,
              country: userData.country,
              trial_type: trialType
            });
          }
          
          // Show success message for contact form submission
          let successMsg = '🎉 Thank you for contacting us! We have received your details and will be in touch soon. You can now take assessments and set up monthly payments.';
          
          showMessage(successMsg, 'success');
          
          // Show logout button
          document.getElementById('logoutBtn').style.display = 'block';
          
          // Reset form
          form.reset();
          // Reset trial type back to default
          document.getElementById('trialType').value = 'Regular Registration';
          // Hide trial banner
          const trialBanner = document.getElementById('trialBanner');
          if (trialBanner) {
            trialBanner.style.display = 'none';
          }
        })
        .catch((error) => {
          console.error('Error registering user: ', error);
          
          // Fallback to email if Firebase fails
          if (error.message.includes('Firebase not configured') || error.message.includes('permission-denied')) {
            console.log('Firebase not configured, falling back to email');
            sendEmailFallback(formData);
          } else {
            showMessage('There was an error registering. Please check your Firebase configuration and try again. Error: ' + error.message, 'error');
          }
        });
    }

    // Email fallback function
    function sendEmailFallback(formData) {
      const studentName = formData.get('studentName');
      const grade = formData.get('grade');
      const courseInterest = formData.get('courseInterest');
      const city = formData.get('city');
      const country = formData.get('country');
      const parentName = formData.get('parentName');
      const email = formData.get('email');
      const phone = formData.get('phone');
      const hearAbout = formData.get('hearAbout');
      const message = formData.get('message');
      
      const subject = `New Student Registration - ${studentName}`;
      const body = `
New Student Registration for STEM Learn

Student Information:
- Name: ${studentName}
- Grade: ${grade}
- Course Interest: ${courseInterest}
- City: ${city}
- Country: ${country}

Parent/Guardian Information:
- Name: ${parentName}
- Email: ${email}
- Phone: ${phone || 'Not provided'}

Additional Information:
- How did you hear about us: ${hearAbout || 'Not provided'}
- Message: ${message || 'No additional message'}

This email was sent from the STEM Learn website contact form.
      `;
      
      const mailtoLink = `mailto:stemlearn.co.uk@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
      window.location.href = mailtoLink;
      
      showMessage('Firebase not configured. Your email client should open with a pre-filled message. Please send the email to complete your registration.', 'warning');
    }

    // Track page views
    if (typeof analytics !== 'undefined') {
      analytics.logEvent('page_view', {
        page_title: 'STEM Learn Home',
        page_location: window.location.href
      });
    }

    // Logout function
    function logoutUser() {
      if (confirm('Are you sure you want to logout? You will need to register again to take assessments.')) {
        // Clear session storage
        sessionStorage.removeItem('userId');
        sessionStorage.removeItem('studentName');
        sessionStorage.removeItem('grade');
        
        // Hide logout button
        document.getElementById('logoutBtn').style.display = 'none';
        
        // Show success message
        showMessage('You have been logged out successfully.', 'success');
      }
    }

    // Check if user is logged in and show logout button
    function checkLoginStatus() {
      const userId = sessionStorage.getItem('userId');
      const studentName = sessionStorage.getItem('studentName');
      
      if (userId && studentName) {
        document.getElementById('logoutBtn').style.display = 'block';
      } else {
        document.getElementById('logoutBtn').style.display = 'none';
      }
    }

    // Check login status when page loads
    document.addEventListener('DOMContentLoaded', function() {
      checkLoginStatus();
      
      // Test Firebase connection after page loads
      setTimeout(async () => {
        try {
          const isFirebaseReady = await testFirebaseConnection();
          if (isFirebaseReady) {
            console.log('🎉 Firebase is ready for use!');
          } else {
            console.warn('⚠️ Firebase is not ready. Form submissions may fall back to email.');
          }
        } catch (error) {
          console.error('Firebase test failed:', error);
        }
      }, 2000); // Wait 2 seconds for Firebase to load
    });

    
    function showMessage(text, type) {
      // Remove existing message if any
      const existingMessage = document.getElementById('formMessage');
      if (existingMessage) {
        existingMessage.remove();
      }
      
      // Create message element
      const message = document.createElement('div');
      message.id = 'formMessage';
      message.style.cssText = `
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 5px;
        text-align: center;
        font-weight: bold;
        background-color: ${type === 'success' ? '#00ff7f' : '#ff4444'};
        color: #0b0c1a;
        border: 1px solid ${type === 'success' ? '#00ff7f' : '#ff4444'};
      `;
      message.textContent = text;
      
      // Insert message after form
      const form = document.getElementById('contactForm');
      form.parentNode.insertBefore(message, form.nextSibling);
      
      // Auto-remove message after 5 seconds
      setTimeout(() => {
        if (message.parentNode) {
          message.remove();
        }
      }, 5000);
    }

    // Course selection and payment variables
    let selectedCourse = null;
    let selectedPrice = 0;
    let stripe = null;
    let elements = null;

    // Initialize Stripe when page loads
    function initializeStripe() {
      // Check if Stripe is loaded
      if (typeof Stripe === 'undefined') {
        console.error('Stripe is not loaded. Please check your internet connection.');
        return false;
      }

      try {
        // Your actual Stripe publishable key
        stripe = Stripe('pk_test_51SECfERo1WoPgABEtOzmAhPrJlaCEmM4cX8updZEYSs1w8x6DrAZixHHBlx41Wqbgxx1ZtJmmrnXaL1wSTxxBcYk00GtS6MPzZ');
        
        elements = stripe.elements();
        const cardElement = elements.create('card', {
          style: {
            base: {
              fontSize: '16px',
              color: '#ffffff',
              '::placeholder': {
                color: '#aab7c4',
              },
            },
            invalid: {
              color: '#ff4444',
            },
          },
        });
        cardElement.mount('#card-element');
        
        cardElement.on('change', function(event) {
          const displayError = document.getElementById('card-errors');
          if (event.error) {
            displayError.textContent = event.error.message;
          } else {
            displayError.textContent = '';
          }
        });
        return true;
      } catch (error) {
        console.error('Error initializing Stripe:', error);
        return false;
      }
    }

    // Course selection function
    function selectCourse(course, price) {
      
      selectedCourse = course;
      selectedPrice = price;
      
      // Show selected course info
      const courseInfo = document.getElementById('courseInfo');
      const selectedCourseDiv = document.getElementById('selectedCourse');
      const paymentSection = document.getElementById('paymentSection');
      const totalAmount = document.getElementById('totalAmount');
      
      
      if (courseInfo && selectedCourseDiv && paymentSection && totalAmount) {
        courseInfo.textContent = `${course.charAt(0).toUpperCase() + course.slice(1).replace('-', ' ')} - £${price}/month (contact us for details)`;
        
        // Force display by removing the inline style and setting new one
        selectedCourseDiv.removeAttribute('style');
        paymentSection.removeAttribute('style');
        
        // Set new styles
        selectedCourseDiv.style.display = 'block';
        selectedCourseDiv.style.backgroundColor = '#0b0c1a';
        selectedCourseDiv.style.padding = '1rem';
        selectedCourseDiv.style.borderRadius = '10px';
        selectedCourseDiv.style.marginBottom = '2rem';
        selectedCourseDiv.style.border = '1px solid #3b82f6';
        
        paymentSection.style.display = 'block';
        paymentSection.style.backgroundColor = '#0b0c1a';
        paymentSection.style.padding = '1.5rem';
        paymentSection.style.borderRadius = '10px';
        paymentSection.style.margin = '2rem 0';
        paymentSection.style.border = '1px solid #3b82f6';
        totalAmount.textContent = `Contact Form`;
        
        // Scroll to the payment section
        paymentSection.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        
        // Initialize Stripe if not already done
        if (!elements) {
          const success = initializeStripe();
          if (!success) {
            showMessage('Payment system is not available. Please contact us directly.', 'error');
          }
        }
      } else {
        console.error('Required elements not found!');
        showMessage('Error: Required form elements not found. Please refresh the page.', 'error');
      }
    }

    // Process payment function with real Stripe integration
    async function processPayment(event) {
      event.preventDefault();
      
      // All form submissions now go to payment processing
      // Free trials are handled via Calendly
      
      if (!selectedCourse || !selectedPrice) {
        showMessage('Please select a course first.', 'error');
        return;
      }

      const form = document.getElementById('contactForm');
      const formData = new FormData(form);
      
      // Show loading state
      const submitBtn = document.getElementById('submitBtn');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Processing Payment...';
      submitBtn.disabled = true;

      try {
        // Create payment intent on your server
        const response = await fetch('http://localhost:3000/create-payment-intent', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            amount: 0, // Free registration
            currency: 'gbp',
            course: selectedCourse,
            monthlyPrice: selectedPrice, // Store monthly price for later
            studentName: formData.get('studentName'),
            grade: formData.get('grade'),
            parentEmail: formData.get('parentEmail'),
            phone: formData.get('phone'),
            message: formData.get('message')
          })
        });

        if (!response.ok) {
          throw new Error('Server error: ' + response.status);
        }

        const { clientSecret } = await response.json();

        // Confirm payment with Stripe
        const { error, paymentIntent } = await stripe.confirmCardPayment(clientSecret, {
          payment_method: {
            card: elements.getElement('card'),
            billing_details: {
              name: formData.get('studentName'),
              email: formData.get('parentEmail'),
            },
          }
        });

        if (error) {
          showMessage(`Payment failed: ${error.message}`, 'error');
        } else if (paymentIntent.status === 'succeeded') {
          // Save registration to Firebase
          await saveNewUser(formData);
          showMessage(`Thank you for contacting us! Your details have been received. Monthly payment of £${selectedPrice} will be set up separately. Welcome to STEM Learn!`, 'success');
          form.reset();
          document.getElementById('selectedCourse').style.display = 'none';
          document.getElementById('paymentSection').style.display = 'none';
        }
      } catch (error) {
        console.error('Payment error:', error);
        if (error.message.includes('fetch')) {
          showMessage('Payment server is not running. Please contact us directly to complete registration.', 'error');
        } else {
          showMessage('Payment processing failed. Please try again.', 'error');
        }
      } finally {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    }

    // Make selectCourse globally accessible
    window.selectCourse = selectCourse;
    window.processPayment = processPayment;

    // Handle form submission - now only handles free registration
    async function handleFormSubmit(event) {
      try {
        event.preventDefault();
        
        // All form submissions now go to free registration
        // Free trials are handled via Calendly
        console.log('Processing free registration');
        await registerUser(event);
        return false;
      } catch (error) {
        console.error('Error in handleFormSubmit:', error);
        showMessage('An error occurred: ' + error.message, 'error');
        return false;
      }
    }
    
    // Make handleFormSubmit globally accessible
    window.handleFormSubmit = handleFormSubmit;
    
    // Test Firebase connection function (for debugging)
    async function testFirebaseConnection() {
      try {
        console.log('Testing Firebase connection...');
        await ensureFirebaseInitialized();
        console.log('✅ Firebase is initialized and ready');
        
        if (typeof window.db !== 'undefined') {
          console.log('✅ Database object is available');
          
          // Try a simple read operation
          const testCollection = window.db.collection('test');
          console.log('✅ Database collection reference created');
          
          return true;
        } else {
          console.error('❌ Database object is not available');
          return false;
        }
      } catch (error) {
        console.error('❌ Firebase connection test failed:', error);
        return false;
      }
    }
    
    // Make test function globally accessible
    window.testFirebaseConnection = testFirebaseConnection;


    // Calendly integration - no JavaScript needed as we're using direct links

    // Mobile Navigation Toggle
    function toggleMobileNav() {
      const hamburger = document.getElementById('hamburger');
      const navMenu = document.getElementById('navMenu');
      
      hamburger.classList.toggle('active');
      navMenu.classList.toggle('active');
    }

    // Mobile dropdown toggle
    function toggleDropdown(event) {
      if (window.innerWidth <= 768) {
        const dropdown = event.target.closest('.dropdown');
        if (dropdown) {
          event.preventDefault();
          dropdown.classList.toggle('active');
        }
      }
    }

    // Initialize Stripe when page loads
    document.addEventListener('DOMContentLoaded', function() {
      
      // Mobile menu toggle
      const hamburger = document.getElementById('hamburger');
      const navMenu = document.getElementById('navMenu');
      
      if (hamburger) {
        hamburger.addEventListener('click', toggleMobileNav);
      }

      // Close mobile menu when clicking outside
      document.addEventListener('click', function(event) {
        if (!event.target.closest('nav') && !event.target.closest('.hamburger')) {
          navMenu.classList.remove('active');
          hamburger.classList.remove('active');
        }
      });

      // Mobile dropdown toggle
      const dropdownLinks = document.querySelectorAll('.dropdown > a');
      dropdownLinks.forEach(link => {
        link.addEventListener('click', toggleDropdown);
      });

      // Close mobile menu when clicking a link
      const navLinks = document.querySelectorAll('nav a');
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (window.innerWidth <= 768) {
            navMenu.classList.remove('active');
            hamburger.classList.remove('active');
          }
        });
      });
      
      // Initialize Stripe after a short delay to ensure it's loaded
      setTimeout(() => {
        initializeStripe();
      }, 1000);
    });
  </script>
</head>
<body>
  <header class="container">
    <div class="logo">STEM Learn</div>
    <div class="hamburger" id="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
    <nav>
      <ul id="navMenu">
        <li class="dropdown">
          <a href="#about">About Us</a>
          <div class="dropdown-content">
            <a href="#about">About Us</a>
            <a href="mentors.html">Our Experts</a>
          </div>
        </li>
        <li class="dropdown">
          <a href="#courses">Programs</a>
          <div class="dropdown-content">
            <a href="#courses">STEM Programs</a>
            <a href="career-counselling.html">Career Counselling</a>
            <a href="private-tuition.html">Private Tuition</a>
            <a href="online-assessment.html">Online Assessment</a>
          </div>
        </li>
        <li><a href="#registration">Contact Us</a></li>
        <li><a href="monthly-payment.html" style="color: #00fff7;">Course Fees</a></li>
        <li id="logoutBtn" style="display: none;">
          <a href="#" onclick="logoutUser(); return false;" style="color: #ff4444;">Logout</a>
        </li>
      </ul>
    </nav>
  </header>

  <section class="hero">
    <div class="floating-elements">
      <div class="floating-code">&lt;div&gt;AI&lt;/div&gt;</div>
      <div class="floating-code">print("Hello World")</div>
      <div class="floating-code">if (learn) { excel(); }</div>
      <div class="floating-code">&lt;script&gt;&lt;/script&gt;</div>
      
      <!-- Tech Icons/Logos -->
      <div class="floating-icon" style="position: absolute; top: 15%; left: 10%; animation: float 6s ease-in-out infinite; font-size: 4rem;">
        🤖
      </div>
      <div class="floating-icon" style="position: absolute; top: 70%; right: 10%; animation: float 7s ease-in-out infinite; animation-delay: 1s; font-size: 4rem;">
        🧠
      </div>
      <div class="floating-icon" style="position: absolute; top: 15%; right: 15%; animation: float 8s ease-in-out infinite; animation-delay: 2s; font-size: 3.5rem;">
        💻
      </div>
      <div class="floating-icon" style="position: absolute; bottom: 20%; left: 15%; animation: float 7s ease-in-out infinite; animation-delay: 1.5s; font-size: 3.5rem;">
        🔬
      </div>
    </div>
    <div class="hero-content">
      <h1 style="font-size: 3rem; font-weight: 900; text-transform: uppercase; letter-spacing: 0.3rem; color: #ffffff; text-shadow: 0 0 20px #00fff7, 0 0 40px #00fff7, 0 3px 6px rgba(0, 0, 0, 0.8); animation: glow 2s ease-in-out infinite alternate;">LEARN. INNOVATE. EXCEL.</h1>
      <p>Excellence in programming education: from visual coding to advanced AI development.</p>
      <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; flex-wrap: wrap; margin-top: 2rem;">
      <a href="#courses" class="btn">See Programs</a>
      </div>
    </div>
  </section>

  <section class="about" id="about">
    <h2>About STEM Learn</h2>
    <p>Embark on an extraordinary journey from fundamental programming principles to cutting-edge artificial intelligence mastery. Our meticulously designed curriculum transforms students into confident technologists through immersive, project-based learning experiences. Master the art of computational thinking, algorithmic problem-solving, and creative coding while building a robust foundation in Python, web technologies, and advanced AI frameworks.</p>
    <p>From intuitive visual programming with Scratch to sophisticated machine learning implementations, students craft everything from intelligent chatbots and predictive models to dynamic web applications and mobile solutions. Each carefully crafted project builds essential skills in software engineering, AI development, and digital innovation. Graduate with an impressive portfolio of AI-powered solutions that demonstrate both technical excellence and creative vision, perfectly positioning you for academic excellence and leadership in tomorrow's technology landscape.</p>
  </section>

  <section class="courses" id="courses">
    <h2>Our Programs</h2>
    <div class="container course-cards">
      <div class="card">
        <h3>Scratch Juniors</h3>
        <p>Perfect introduction to programming through visual Scratch coding, hands-on micro:bit projects, 
           and beginner-friendly AI concepts. Young learners build games, animations, and interactive 
           projects while developing computational thinking skills.</p>
        <a class="btn" href="courses/scratch-juniors.html">Learn More</a>
      </div>
      <div class="card">
        <h3>Young Coders</h3>
        <p>A comprehensive project‑driven pathway covering core programming concepts, problem solving, 
           and introduction to AI. Students master Python, web development, app creation, and AI projects 
           while preparing for GCSE and A-Level Computer Science success.</p>
        <a class="btn" href="courses/young-coders.html">Learn More</a>
      </div>
      <div class="card">
        <h3>Private Tuition</h3>
        <p>One-on-one personalized learning experience tailored to your child's specific needs and learning 
           style. Flexible scheduling, customized curriculum, and focused attention to help your child excel 
           in any subject or prepare for specific exams.</p>
        <a class="btn" href="private-tuition.html">Learn More</a>
      </div>
    </div>
  </section>

  <section class="contact" id="contact">
    <h2>Pricing & Registration</h2>
    <p style="color: #e2e8f0; margin-bottom: 2rem; font-size: 1.3rem; line-height: 1.7;">Choose Your Learning Path and Get Started Today</p>
    
    <!-- Registration Process Explanation -->
    <div style="background-color: #1f1f3f; padding: 1.5rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #3b82f6; text-align: center;">
      <h4 style="color: #3b82f6; margin-bottom: 1rem;">Simple Registration Process</h4>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; color: #ccc; margin-bottom: 2rem;">
        <div style="background-color: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid #3b82f6;">
          <strong style="color: #3b82f6; font-size: 1.1rem;">Step 1: Register</strong><br>
          <span style="font-size: 0.95rem;">Free registration to secure your spot</span>
        </div>
        <div style="background-color: rgba(255, 107, 53, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid #ff6b35;">
          <strong style="color: #ff6b35; font-size: 1.1rem;">Step 2: Monthly Setup</strong><br>
          <span style="font-size: 0.95rem;">Set up recurring payment</span>
        </div>
      </div>
      
      <!-- Action Buttons -->
      <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
        <a href="#registration" style="background: linear-gradient(45deg, #00fff7, #3b82f6); color: #0b0c1a; padding: 0.75rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease;">
          Contact Us
        </a>
        <a href="monthly-payment.html" style="background: linear-gradient(45deg, #ff6b35, #ff8c42); color: #0b0c1a; padding: 0.75rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease;">
          Course Fees
        </a>
      </div>
    </div>
    
    
    <!-- Pricing Section -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
      <!-- Scratch Juniors Pricing -->
      <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #00fff7; text-align: center;">
        <h3 style="color: #00fff7; font-size: 1.5rem; margin-bottom: 1rem;">Scratch Juniors</h3>
        <p style="color: #ccc; margin-bottom: 1rem;">Ages 7-11</p>
        <div style="font-size: 2.5rem; color: #3b82f6; font-weight: bold; margin-bottom: 1rem;">£19.99<span style="font-size: 1rem; color: #ccc;">/month</span></div>
        <div style="color: #00ff7f; font-weight: bold; margin-bottom: 1rem;">+ Free Registration</div>
        <ul style="color: #ccc; text-align: left; margin-bottom: 2rem;">
          <li>Project-based curriculum</li>
          <li>Computer science fundamentals</li>
          <li>Scratch programming & micro:bit</li>
          <li>AI concepts for young learners</li>
          <li>Weekly 1 hr session</li>
        </ul>
        <a href="monthly-payment.html" style="background: linear-gradient(45deg, #00fff7, #3b82f6); color: #0b0c1a; padding: 0.75rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease; display: inline-block;">Course Fees</a>
      </div>
      
      <!-- Young Coders Pricing -->
      <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #3b82f6; text-align: center;">
        <h3 style="color: #3b82f6; font-size: 1.5rem; margin-bottom: 1rem;">Young Coders</h3>
        <p style="color: #ccc; margin-bottom: 1rem;">Ages 12-16</p>
        <div style="font-size: 2.5rem; color: #3b82f6; font-weight: bold; margin-bottom: 1rem;">£24.99<span style="font-size: 1rem; color: #ccc;">/month</span></div>
        <div style="color: #00ff7f; font-weight: bold; margin-bottom: 1rem;">+ Free Registration</div>
        <ul style="color: #ccc; text-align: left; margin-bottom: 2rem;">
          <li>Project based comprehensive curriculum</li>
          <li>Python programming mastery</li>
          <li>Web development & app creation</li>
          <li>AI & machine learning projects</li>
          <li>Weekly 1-hour sessions</li>
        </ul>
        <a href="monthly-payment.html" style="background: linear-gradient(45deg, #3b82f6, #00fff7); color: #0b0c1a; padding: 0.75rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease; display: inline-block;">Course Fees</a>
      </div>
      
      <!-- Private Tuition Pricing -->
      <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #ff6b35; text-align: center;">
        <h3 style="color: #ff6b35; font-size: 1.5rem; margin-bottom: 1rem;">Private Tuition</h3>
        <p style="color: #ccc; margin-bottom: 1rem;">All Ages</p>
        <div style="font-size: 1.2rem; color: #ff6b35; font-weight: bold; margin-bottom: 1rem; text-align: center;">Custom/Session Payment</div>
        <ul style="color: #ccc; text-align: left; margin-bottom: 2rem;">
          <li>Personalized learning experience</li>
          <li>11+ Grammar School Preparation</li>
          <li>Primary School Maths/Science/English</li>
          <li>Secondary School Maths/Science</li>
          <li>Flexible scheduling</li>
        </ul>
        <a href="monthly-payment.html" style="background: linear-gradient(45deg, #ff6b35, #ff8c42); color: #0b0c1a; padding: 0.75rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease; display: inline-block; margin-top: 5rem;">Course Fees</a>
      </div>
      
    </div>
    
    <div class="container">
      <!-- Ready to Transform Your Future Section - Top -->
      <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #3b82f6; text-align: center; margin-bottom: 3rem;">
        <h3 style="color: #3b82f6; font-size: 2rem; margin-bottom: 1.5rem;">Ready to Transform Your Future?</h3>
        <p style="color: #e2e8f0; font-size: 1.2rem; margin-bottom: 1rem; line-height: 1.8;">
          Be among the first to experience our innovative AI and programming education platform. Master cutting-edge technology through our comprehensive, project-based learning approach.
        </p>
        <p style="color: #e2e8f0; font-size: 1.2rem; margin-bottom: 0; line-height: 1.8;">
          Our expert instructors guide you from visual programming basics to advanced AI development, preparing you for GCSE/A-Level success and future tech careers.
        </p>
      </div>
      
      <!-- Registration Form Section - Middle -->
      <div id="registration" style="max-width: 800px; margin: 0 auto 3rem auto;">
        <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #00d9ff; text-align: left;">
          <h3 style="color: #00d9ff; font-size: 1.8rem; margin-bottom: 2rem; text-align: center;">Contact Us</h3>
          <div class="contact-form">
           <!-- Free Trial Banner -->
           
           <!-- Course Selection Display -->
           <div id="selectedCourse" style="display: none; background-color: #0b0c1a; padding: 1rem; border-radius: 10px; margin-bottom: 2rem; border: 1px solid #3b82f6;">
             <h4 style="color: #3b82f6; margin-bottom: 0.5rem;">Selected Course</h4>
             <p id="courseInfo" style="color: #ccc; margin: 0;"></p>
           </div>

           <form id="contactForm" onsubmit="handleFormSubmit(event); return false;">
            <!-- Hidden field for trial type -->
            <input type="hidden" id="trialType" name="trialType" value="Regular Registration">
            
            <div class="form-group">
              <label for="studentName">Student's Name *</label>
              <input type="text" id="studentName" name="studentName" required>
            </div>
            
            <div class="form-group">
              <label for="grade">Grade *</label>
              <select id="grade" name="grade" required>
                <option value="">Select Your Grade</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="Undergraduate">Undergraduate</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="courseInterest">Course Interest *</label>
              <select id="courseInterest" name="courseInterest" required>
                <option value="">Select Your Course Interest</option>
                <option value="Scratch Juniors">Scratch Juniors (Ages 7-11)</option>
                <option value="Young Coders">Young Coders (Ages 12-16)</option>
                <option value="Career Guidance">Career Guidance</option>
                <option value="11+ Grammar School Preparation">11+ Grammar School Preparation</option>
                <option value="Primary School Maths/Science/English">Primary School Maths/Science/English Classes</option>
                <option value="Secondary School Maths/Science">Secondary School Maths/Science Classes</option>
                <option value="Private Tuition">Private Tuition</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="city">Which city do you live in? *</label>
              <input type="text" id="city" name="city" required>
            </div>
            
            <div class="form-group">
              <label for="country">Which country do you live in? *</label>
              <input type="text" id="country" name="country" required>
            </div>
            
            <div class="form-group">
              <label for="parentName">Parent's/Guardian's Name *</label>
              <input type="text" id="parentName" name="parentName" required>
            </div>
            
            <div class="form-group">
              <label for="email">Email *</label>
              <input type="email" id="email" name="email" required>
            </div>
            
            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input type="tel" id="phone" name="phone">
            </div>
            
            <div class="form-group">
              <label for="hearAbout">How did you hear about us?</label>
              <input type="text" id="hearAbout" name="hearAbout">
            </div>
            
            <div class="form-group">
              <label for="message">Message</label>
              <textarea id="message" name="message" placeholder="Tell us about your interest in our programs..."></textarea>
            </div>
            
            <!-- Payment Section -->
            <div id="paymentSection" style="display: none; background-color: #0b0c1a; padding: 1.5rem; border-radius: 10px; margin: 2rem 0; border: 1px solid #3b82f6;">
              <h4 style="color: #3b82f6; margin-bottom: 1rem;">Registration Payment</h4>
              <p style="color: #ccc; margin-bottom: 1rem; font-size: 0.9rem;">Submit your details to contact us. Monthly payments will be set up separately after registration.</p>
              
              <!-- Stripe Elements will be inserted here -->
              <div id="card-element" style="background-color: #1f1f3f; padding: 1rem; border-radius: 5px; margin-bottom: 1rem;">
                <!-- Stripe Elements will create form elements here -->
              </div>
              
              <!-- Display any errors -->
              <div id="card-errors" role="alert" style="color: #ff4444; margin-bottom: 1rem;"></div>
              
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                <span style="color: #ccc;">Total Amount:</span>
                <span id="totalAmount" style="color: #3b82f6; font-size: 1.2rem; font-weight: bold;">£0</span>
              </div>
            </div>
            
             <button type="submit" class="submit-btn" id="submitBtn">Submit</button>
          </form>
          
          <p style="color: #aaa; font-size: 0.9rem; margin-top: 1rem; text-align: center;">
            <strong>Privacy Note:</strong> We do not sell or share your contact details with anyone, EVER.
          </p>
          
          <!-- Registration CTA -->
          <div style="background: linear-gradient(45deg, #3b82f6, #00fff7); padding: 2rem; border-radius: 15px; text-align: center; margin-top: 2rem;">
            <h3 style="color: #0b0c1a; font-size: 1.5rem; margin-bottom: 1rem;">Ready to Start Your STEM Journey?</h3>
            <p style="color: #0b0c1a; margin-bottom: 1.5rem; font-size: 1.1rem;">Join thousands of students learning the skills of the future</p>
            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
              <a href="#registration" style="background: #0b0c1a; color: #00fff7; padding: 1rem 2rem; border-radius: 5px; text-decoration: none; font-weight: bold; transition: all 0.3s ease; border: 2px solid #0b0c1a;">
                Contact Us
              </a>
            </div>
          </div>
          </div>
        </div>
      </div>
      
      <!-- Email Contact Box -->
      <div style="background-color: #1f1f3f; padding: 2rem; border-radius: 15px; border: 1px solid #00fff7; text-align: center; margin-top: 3rem;">
        <p style="color: #00fff7; font-weight: bold; margin-bottom: 0.5rem; font-size: 1.1rem;">Contact Us</p>
        <p class="email" style="color: #3b82f6; font-weight: bold; font-size: 1.3rem; margin-bottom: 1rem; text-align: center; word-break: break-all;">stemlearn.co.uk@gmail.com</p>
        <p style="color: #ccc; font-size: 1rem; line-height: 1.5; text-align: center;">
          We typically respond within 24 hours and are here to answer all your questions about our programs.
        </p>
      </div>
    </div>
  </section>

  <footer>
    &copy; 2025 STEM Learn | All Rights Reserved
  </footer>
</body>
</html>
